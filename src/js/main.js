// Translations
const translations = {
  de: {
    // Nav
    navHome: "Startseite",
    navShop: "Sortiment",
    navAbout: "Über uns",
    navContact: "Kontakt",
    // Hero
    heroTagline: "Ihr Premium Florist seit 2006",
    heroTitle: "Blumen, die Herzen berühren",
    heroDescription: "Hochzeitsfloristik, Eventdekoration & kreative Blumenarrangements im Pariser Stil. Frisch geliefert mit Liebe und Leidenschaft.",
    heroBtnShop: "Sortiment entdecken",
    heroBtnContact: "Jetzt anfragen",
    heroTrust: "Über 50 Google-Bewertungen",
    // Features
    featuresTitle: "Unsere Leistungen",
    featureDecorTitle: "Deko-Verleih",
    featureDecorDesc: "Vasen, Hussen, Windlichter und vieles mehr zum Ausleihen für Ihr Fest.",
    featureCustomTitle: "Sonderanfertigungen",
    featureCustomDesc: "Jedes Projekt einzigartig gestaltet. Wir visualisieren Ihre Themen perfekt.",
    featurePrivateTitle: "Private Feste",
    featurePrivateDesc: "Genießen Sie Ihre Feier unbeschwert. Wir kümmern uns um die Dekoration.",
    featureEventTitle: "Eventdekorationen",
    featureEventDesc: "Messen, Galas oder Firmenevents – wir inszenieren Ihren Auftritt professionell.",
    featureServiceTitle: "Blumenservice",
    featureServiceDesc: "Wöchentliche Lieferungen, Corporate Decor und exklusive Geschenke.",
    featureLargeTitle: "Großraumdekorationen",
    featureLargeDesc: "Von Abibällen bis zu Galanächten mit über 1.000 Gästen.",
    // Shop
    shopTitle: "Unser Sortiment",
    serviceWeddingTitle: "Hochzeitsfloristik",
    serviceWeddingDesc: "Traumhafte Arrangements für Ihren schönsten Tag.",
    serviceEventTitle: "Event-Design",
    serviceEventDesc: "Stilvolle Konzepte für Firmenfeiern und Galas.",
    serviceFuneralTitle: "Trauerfloristik",
    serviceFuneralDesc: "Würdevoller Abschied mit eleganten Blumen.",
    serviceInteriorTitle: "Interior Begrünung",
    serviceInteriorDesc: "Grüne Oasen für Büros und Zuhause.",
    serviceWorkshopsTitle: "Workshops",
    serviceWorkshopsDesc: "Lernen Sie die Kunst des Blumenbindens.",
    serviceSubTitle: "Blumen-Abo",
    serviceSubDesc: "Frische Blumen regelmäßig direkt zu Ihnen.",
    // Craftsmanship
    craftLabel: "UNSERE PHILOSOPHIE",
    craftTitle: "Mit Liebe & Leidenschaft gefertigt",
    craftSubtitle: "Jedes Arrangement ist ein Unikat - von Hand geschaffen, mit Herz vollendet",
    craftStep1Title: "Persönliche Beratung",
    craftStep1Desc: "Wir hören zu, verstehen Ihre Vision und entwickeln gemeinsam das perfekte Konzept für Ihren Anlass.",
    craftStep2Title: "Handverlesene Auswahl",
    craftStep2Desc: "Nur die frischesten Blumen und edelsten Materialien finden den Weg in unsere Kreationen.",
    craftStep3Title: "Kunstvolle Gestaltung",
    craftStep3Desc: "Mit geschickten Händen und jahrelanger Erfahrung entstehen florale Meisterwerke im Pariser Stil.",
    craftStep4Title: "Lieferung mit Liebe",
    craftStep4Desc: "Pünktlich und sorgfältig liefern wir Ihre Blumenträume direkt zu Ihnen oder Ihrem Event.",
    craftQuote: "\"Blumen sind die Poesie der Natur - wir übersetzen sie in Ihre persönliche Sprache.\"",
    // About
    aboutLabel: "SEIT 2006",
    aboutTitle: "Santa Maria Blumen",
    aboutText1: "Was als kleine Blumenboutique begann, ist heute ein Atelier für florale Kunst. Über die Jahre haben wir unzählige Geschichten mit Blumen erzählt - von romantischen Hochzeiten bis zu eleganten Firmengalas.",
    aboutText2: "Unser Markenzeichen ist der Pariser Stil mit barocker Eleganz. Wir sind besessen davon, die schönsten Events zu gestalten! Mit Stoff, Blumen, Holz, Farbe und Kreativität erschaffen wir Magie, die Ihre Gäste verzaubert.",
    aboutYears: "Jahre Erfahrung",
    aboutEvents: "Events gestaltet",
    aboutReviews: "5-Sterne Bewertungen",
    aboutTeamTitle: "Unser Team",
    teamSubtitle: "Die Menschen hinter der Magie",
    teamRoleOwner: "Inhaberin & Kreativdirektorin",
    teamRoleLogistics: "Logistik",
    teamRolePlanner: "Planner",
    teamRoleEvent: "Eventmanagement",
    teamRoleVideo: "Videography & Photography",
    // Gallery
    galleryLabel: "EINBLICKE",
    galleryTitle: "Unser Atelier",
    gallerySubtitle: "Entdecken Sie unsere Welt der Blumen",
    galleryVideoText: "Ein Blick in unsere magische Welt",
    // Testimonials
    testimonialsTitle: "Was unsere Kunden sagen",
    testimonialsSubtitle: "Über 50 Fünf-Sterne-Bewertungen auf Google",
    testimonialsBtn: "Alle Bewertungen auf Google ansehen",
    // Contact
    contactTitle: "Kontakt & Öffnungszeiten",
    contactSubtitle: "Wir freuen uns auf Ihre Anfrage!",
    contactAddressTitle: "Adresse",
    contactPhoneTitle: "Telefon",
    contactEmailTitle: "E-Mail",
    contactHoursTitle: "Wann arbeiten wir?",
    contactHoursText: "Für Sie den ganzen Tag - jeden Tag",
    contactCtaText: "Bereit für Ihr nächstes Event?",
    contactCtaButton: "Jetzt Anfrage senden",
    // Footer
    footerImpressum: "Impressum",
    footerAGB: "AGB",
    footerPrivacy: "Datenschutz",
    footerRights: "Santa Maria Blumen. Alle Rechte vorbehalten."
  },
  en: {
    // Nav
    navHome: "Home",
    navShop: "Assortment",
    navAbout: "About Us",
    navContact: "Contact",
    // Hero
    heroTagline: "Your Premium Florist since 2006",
    heroTitle: "Flowers that touch hearts",
    heroDescription: "Wedding floristry, event decoration & creative flower arrangements in Parisian style. Freshly delivered with love and passion.",
    heroBtnShop: "Discover Assortment",
    heroBtnContact: "Inquire Now",
    heroTrust: "Over 50 Google Reviews",
    // Features
    featuresTitle: "Our Services",
    featureDecorTitle: "Decor Rental",
    featureDecorDesc: "Vases, covers, lanterns and much more to rent for your party.",
    featureCustomTitle: "Custom Designs",
    featureCustomDesc: "Every project uniquely designed. We visualize your themes perfectly.",
    featurePrivateTitle: "Private Parties",
    featurePrivateDesc: "Enjoy your celebration carefree. We take care of the decoration.",
    featureEventTitle: "Event Decorations",
    featureEventDesc: "Trade fairs, galas or corporate events – we stage your appearance professionally.",
    featureServiceTitle: "Flower Service",
    featureServiceDesc: "Weekly deliveries, corporate decor and exclusive gifts.",
    featureLargeTitle: "Large Scale Decorations",
    featureLargeDesc: "From prom nights to gala nights with over 1,000 guests.",
    // Shop
    shopTitle: "Our Assortment",
    serviceWeddingTitle: "Wedding Floristry",
    serviceWeddingDesc: "Dreamlike arrangements for your most beautiful day.",
    serviceEventTitle: "Event Design",
    serviceEventDesc: "Stylish concepts for corporate parties and galas.",
    serviceFuneralTitle: "Funeral Floristry",
    serviceFuneralDesc: "Dignified farewell with elegant flowers.",
    serviceInteriorTitle: "Interior Greening",
    serviceInteriorDesc: "Green oases for offices and homes.",
    serviceWorkshopsTitle: "Workshops",
    serviceWorkshopsDesc: "Learn the art of flower arranging.",
    serviceSubTitle: "Flower Subscription",
    serviceSubDesc: "Fresh flowers regularly delivered directly to you.",
    // Craftsmanship
    craftLabel: "OUR PHILOSOPHY",
    craftTitle: "Crafted with Love & Passion",
    craftSubtitle: "Each arrangement is unique - handcrafted with heart and soul",
    craftStep1Title: "Personal Consultation",
    craftStep1Desc: "We listen, understand your vision and develop the perfect concept for your occasion together.",
    craftStep2Title: "Hand-Selected Materials",
    craftStep2Desc: "Only the freshest flowers and finest materials find their way into our creations.",
    craftStep3Title: "Artful Design",
    craftStep3Desc: "With skilled hands and years of experience, floral masterpieces emerge in Parisian style.",
    craftStep4Title: "Delivery with Love",
    craftStep4Desc: "Punctually and carefully, we deliver your floral dreams directly to you or your event.",
    craftQuote: "\"Flowers are nature's poetry - we translate them into your personal language.\"",
    // About
    aboutLabel: "SINCE 2006",
    aboutTitle: "Santa Maria Blumen",
    aboutText1: "What began as a small flower boutique is now an atelier for floral art. Over the years, we have told countless stories with flowers - from romantic weddings to elegant corporate galas.",
    aboutText2: "Our trademark is the Parisian style with baroque elegance. We are obsessed with creating the most beautiful events! With fabric, flowers, wood, color and creativity, we create magic that enchants your guests.",
    aboutYears: "Years Experience",
    aboutEvents: "Events Created",
    aboutReviews: "5-Star Reviews",
    aboutTeamTitle: "Our Team",
    teamSubtitle: "The people behind the magic",
    teamRoleOwner: "Owner & Creative Director",
    teamRoleLogistics: "Logistics",
    teamRolePlanner: "Planner",
    teamRoleEvent: "Event Management",
    teamRoleVideo: "Videography & Photography",
    // Gallery
    galleryLabel: "INSIGHTS",
    galleryTitle: "Our Atelier",
    gallerySubtitle: "Discover our world of flowers",
    galleryVideoText: "A glimpse into our magical world",
    // Testimonials
    testimonialsTitle: "What Our Customers Say",
    testimonialsSubtitle: "Over 50 Five-Star Reviews on Google",
    testimonialsBtn: "View All Reviews on Google",
    // Contact
    contactTitle: "Contact & Opening Hours",
    contactSubtitle: "We look forward to hearing from you!",
    contactAddressTitle: "Address",
    contactPhoneTitle: "Phone",
    contactEmailTitle: "Email",
    contactHoursTitle: "When do we work?",
    contactHoursText: "For you all day - every day",
    contactCtaText: "Ready for your next event?",
    contactCtaButton: "Send inquiry now",
    // Footer
    footerImpressum: "Imprint",
    footerAGB: "T&C",
    footerPrivacy: "Privacy Policy",
    footerRights: "Santa Maria Blumen. All rights reserved."
  }
};

// Language Switching Logic
function setLanguage(lang) {
  const elements = document.querySelectorAll('[data-i18n]');
  elements.forEach(el => {
    const key = el.getAttribute('data-i18n');
    if (translations[lang] && translations[lang][key]) {
      el.textContent = translations[lang][key];
    }
  });

  // Update buttons state
  document.querySelectorAll('.lang-btn').forEach(btn => {
    btn.classList.toggle('active', btn.getAttribute('data-lang') === lang);
  });
}

document.addEventListener('DOMContentLoaded', () => {
  // Set default language to German on page load
  setLanguage('de');

  // Language Switcher Event Listeners
  document.querySelectorAll('.lang-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const lang = btn.getAttribute('data-lang');
      setLanguage(lang);
    });
  });

  // Mobile Menu Toggle
  const menuToggle = document.querySelector('.mobile-menu-toggle');
  const mainNav = document.querySelector('.main-nav');

  if (menuToggle && mainNav) {
    menuToggle.addEventListener('click', () => {
      mainNav.classList.toggle('active');
      menuToggle.classList.toggle('active');
    });
  }

  // Smooth Scrolling for Anchor Links
  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
      e.preventDefault();
      const targetId = this.getAttribute('href');
      if (targetId === '#') return;

      const targetElement = document.querySelector(targetId);
      if (targetElement) {
        targetElement.scrollIntoView({
          behavior: 'smooth'
        });
        // Close mobile menu if open
        mainNav.classList.remove('active');
        menuToggle.classList.remove('active');
      }
    });
  });

  // Fade-in Animation on Scroll
  const observerOptions = {
    root: null,
    rootMargin: '0px',
    threshold: 0.1
  };

  const observer = new IntersectionObserver((entries, observer) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
        observer.unobserve(entry.target);
      }
    });
  }, observerOptions);

  document.querySelectorAll('.fade-in-section').forEach(section => {
    observer.observe(section);
  });

  // Header Logo Change on Scroll (throttled for performance)
  const headerLogo = document.getElementById('header-logo');
  const heroSection = document.getElementById('home');

  if (headerLogo && heroSection) {
    let ticking = false;
    let lastExpanded = false;
    const heroBottom = heroSection.offsetHeight;

    window.addEventListener('scroll', () => {
      if (!ticking) {
        requestAnimationFrame(() => {
          const scrollPosition = window.scrollY;
          const shouldExpand = scrollPosition > heroBottom - 100;

          // Only update DOM if state changed
          if (shouldExpand !== lastExpanded) {
            if (shouldExpand) {
              headerLogo.textContent = 'Santa Maria Blumen';
              headerLogo.classList.add('expanded');
            } else {
              headerLogo.textContent = 'SMB';
              headerLogo.classList.remove('expanded');
            }
            lastExpanded = shouldExpand;
          }
          ticking = false;
        });
        ticking = true;
      }
    }, { passive: true });
  }

  // Lazy load background images
  const lazyBgImages = document.querySelectorAll('.feature-image, .product-image, .gallery-item');
  if ('IntersectionObserver' in window && lazyBgImages.length > 0) {
    const bgObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('bg-loaded');
          bgObserver.unobserve(entry.target);
        }
      });
    }, { rootMargin: '100px' });

    lazyBgImages.forEach(el => bgObserver.observe(el));
  }
});
